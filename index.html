const loginScreen = document.getElementById('loginScreen');
const travelScreen = document.getElementById('travelScreen');
const onBtn = document.getElementById('onBtn');
const destList = document.querySelector('.dest-list');
const logEl = document.getElementById('log');
let traveling = false;

// Main planet destinations
const mainDestinations = [
  { name: "Earth Command Center", key: "Earth" },
  { name: "Mars Colony Alpha", key: "Mars" },
  { name: "Jupiter Orbital Station", key: "Jupiter" },
  { name: "Europa Research Base", key: "Europa" },
  { name: "Andromeda Outpost", key: "Andromeda" },
  { name: "Vega Prime", key: "Vega" },
];

// Earth sub-destinations
const earthSubDestinations = [
  { name: "Return to Ship", key: "Return" },
  { name: "New York Sector", key: "NewYork" },
  { name: "Lunar Colony", key: "Lunar" },
  { name: "Pacific Research Facility", key: "Pacific" },
];

// Helper to create buttons
function createButtons(destinations) {
  destList.innerHTML = '<h2>Select Destination</h2>';
  destinations.forEach(dest => {
    const btn = document.createElement('button');
    btn.textContent = dest.name;
    btn.dataset.dest = dest.key;
    destList.appendChild(btn);

    btn.addEventListener('click', () => {
      if (traveling) return;

      // If clicked Return to Ship, restore main menu
      if (dest.key === 'Return') {
        populateDestinations(mainDestinations);
        appendLog("System: Returning to ship. Please select a destination.");
        return;
      }

      // If clicked Earth, switch to Earth sub-menu
      if (dest.key === 'Earth') {
        populateDestinations(earthSubDestinations);
        appendLog("System: Accessing Earth sectors. Select your sub-destination.");
        return;
      }

      traveling = true;
      // Disable all buttons during travel
      const allButtons = destList.querySelectorAll('button');
      allButtons.forEach(b => {
        b.disabled = true;
        b.classList.remove('selected');
      });
      btn.classList.add('selected');

      appendLog(`System: Initiating zero-point travel to ${dest.name}...`);

      setTimeout(() => {
        appendLog(`System: Zero-point travel finished, welcome to ${dest.name}. Enjoy your expedition.`);
        traveling = false;
        allButtons.forEach(b => b.disabled = false);
      }, 3000);
    });
  });
}

function appendLog(text) {
  const line = document.createElement('div');
  line.textContent = text;
  logEl.appendChild(line);
  logEl.scrollTop = logEl.scrollHeight;
}

// On button click: switch screens and init log, load main destinations
onBtn.addEventListener('click', () => {
  loginScreen.classList.add('hidden');
  travelScreen.classList.remove('hidden');
  appendLog('System: Welcome, Captain. Please select a destination.');
  populateDestinations(mainDestinations);
});

function populateDestinations(destinations) {
  createButtons(destinations);
}
